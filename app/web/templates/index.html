<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Amazon Trend Finder AI — App</title>

  <!-- Ortak stiller -->
  <link rel="stylesheet" href="/static/css/landing.css?v=1">
  <link rel="stylesheet" href="/static/css/styles.css?v=app-final-7">
</head>

<body data-mode="{{ mode or 'demo' }}">
  <!-- ===== SELF-CONTAINED PRELOADER (shows no matter what) ===== -->
 <!-- ===== PRELOADER (modern 3-dot animation) ===== -->
<div id="preloader" style="
  position:fixed; inset:0;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  background:rgba(2,6,23,.94); backdrop-filter:blur(3px);
  z-index:10000; transition:opacity .6s ease; opacity:1;
">
  <div style="display:flex; gap:10px;">
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
  </div>
  <p id="preloaderText" style="margin-top:14px; font-size:15px; color:#9ca3af;">
    {{ 'Loading Pro…' if (mode=='pro') else 'Loading Demo…' }}
  </p>
</div>

<style>
  .dot {
    width:14px; height:14px; border-radius:50%;
    background-color:#38bdf8;
    animation: pulse 1.2s ease-in-out infinite;
  }
  .dot:nth-child(1){ animation-delay:0s; }
  .dot:nth-child(2){ animation-delay:0.2s; }
  .dot:nth-child(3){ animation-delay:0.4s; }

  @keyframes pulse {
    0%, 80%, 100% { transform:scale(0.6); opacity:0.5; }
    40% { transform:scale(1); opacity:1; }
  }
</style>

<script>
  // ✅ Preloader hide (1 saniye daha uzun bekle)
  window.preloaderHide = function(){
    const el = document.getElementById('preloader');
    if (!el) return;
    setTimeout(function(){
      el.style.opacity = '0';
      el.style.pointerEvents = 'none';
      setTimeout(()=>{ try{ el.remove(); }catch(e){ el.style.display='none'; } }, 600);
    }, 2500); // 2 saniye bekle (önceden 1 saniyeydi)
  };

  // güvence: sayfa yüklenince de gizle
  window.addEventListener('load', window.preloaderHide);
  // fallback: 6 saniye sonra mutlaka gizle
  setTimeout(()=>{ if(document.getElementById('preloader')) window.preloaderHide(); }, 6000);
</script>
<!-- ===== /PRELOADER ===== -->


  {% include "_nav.html" %}
  <!-- ... geri kalan içerik ... -->



  {# Demo bilgilendirme şeridi — CTA sadece burada #}
  {% if mode == 'demo' %}
    <div class="upgrade-banner" role="status">
      You’re using the free demo. Last 6 weeks only, advanced filters disabled.
      <a href="{{ url_for('checkout') }}" class="btn small">Upgrade to Pro</a>
    </div>
  {% endif %}


  <!-- Filtreler -->
  <section class="controls" aria-labelledby="filtersTitle">
    <h2 id="filtersTitle" class="hidden">Filters</h2>

    <div>
      <label for="start">Start week</label>
      <select id="start" name="start"></select>
    </div>

    <div>
      <label for="end">End week</label>
      <select id="end" name="end"></select>
    </div>

    <div>
      <label for="include">Include (comma-separated)</label>
      <input id="include" name="include" placeholder="iphone, crocs..." autocomplete="off"/>
    </div>

    <div>
      <label for="exclude">Exclude (comma-separated)</label>
      <input id="exclude" name="exclude" placeholder="case, charger..." autocomplete="off"/>
    </div>

    <div class="actions">
      <button id="run" class="btn" aria-label="Find uptrends">Find uptrends</button>
    </div>
  </section>

  <!-- Özet -->
  <section class="summary" aria-live="polite">
    <span id="found" class="pill">Found: 0</span>
    <span id="range" class="pill"></span>

    <span id="status" class="loading hidden" aria-hidden="true">
      <span class="dot"></span><span class="dot"></span><span class="dot"></span> Loading…
    </span>
  </section>

  <!-- Sonuç Tablosu -->
  <section aria-labelledby="resultsTitle">
    <h2 id="resultsTitle" class="hidden">Results</h2>
    <table id="tbl">
      <thead>
        <tr>
          <th data-key="term">Term</th>
          <th data-key="start_rank">Start rank</th>
          <th data-key="end_rank">End rank</th>
          <th data-key="total_improvement">Total improvement</th>
          <th data-key="weeks">Weeks</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div id="empty" class="hidden">No results. Try relaxing your filters.</div>
  </section>

  <!-- Modal (grafik) -->
  <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-card">
      <div class="modal-header">
        <h3 id="modalTitle">Trend</h3>
        <button id="closeModal" class="btn" aria-label="Close">✕</button>
      </div>
      <div id="chart" class="chart"></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast hidden" role="status" aria-live="polite"></div>

  <!-- App JS -->
  <script src="/static/js/app.js" defer></script>
</body>
</html>
